USE sql_master;

   1. Count students per course
  
SELECT c.course_name,
       COUNT(s.student_id) AS total_students
FROM students s
JOIN courses c
  ON s.student_id = c.student_id
GROUP BY c.course_name;


   2. Courses having more than 1 student

SELECT c.course_name,
       COUNT(s.student_id) AS total_students
FROM students s
JOIN courses c
  ON s.student_id = c.student_id
GROUP BY c.course_name
HAVING total_students > 1;


   3. Count students per department
  
SELECT d.dept_name,
       COUNT(s.student_id) AS total_students
FROM students s
JOIN courses c
  ON s.student_id = c.student_id
JOIN departments d
  ON c.course_id = d.course_id
GROUP BY d.dept_name;


   4. Departments with more than 1 student
 
SELECT d.dept_name,
       COUNT(s.student_id) AS total_students
FROM students s
JOIN courses c
  ON s.student_id = c.student_id
JOIN departments d
  ON c.course_id = d.course_id
GROUP BY d.dept_name
HAVING total_students > 1;


   5. Course with the least number of students
  
SELECT c.course_name,
       COUNT(s.student_id) AS total_students
FROM students s
RIGHT JOIN courses c
  ON s.student_id = c.student_id
GROUP BY c.course_name
ORDER BY total_students ASC
LIMIT 1;


   6. Average age of students per course
  
SELECT c.course_name,
       AVG(s.student_age) AS average_age
FROM students s
JOIN courses c
  ON s.student_id = c.student_id
GROUP BY c.course_name;


   7. Courses where average age is above 21
 
SELECT c.course_name,
       AVG(s.student_age) AS average_age
FROM students s
JOIN courses c
  ON s.student_id = c.student_id
GROUP BY c.course_name
HAVING average_age > 21;


   8. Count number of courses per student
   
SELECT s.student_name,
       COUNT(c.course_id) AS total_courses
FROM students s
LEFT JOIN courses c
  ON s.student_id = c.student_id
GROUP BY s.student_name;


   9. Students enrolled in more than one course
 
SELECT s.student_name,
       COUNT(c.course_id) AS total_courses
FROM students s
LEFT JOIN courses c
  ON s.student_id = c.student_id
GROUP BY s.student_name
HAVING total_courses > 1;


   10. Students older than average age with course name
  
SELECT s.student_name,
       c.course_name
FROM students s
JOIN courses c
  ON s.student_id = c.student_id
WHERE s.student_age >
      (SELECT AVG(student_age) FROM students);
